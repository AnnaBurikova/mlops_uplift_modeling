# Uplift Modeling 

## 1. Цель проекта (Business Goal)

В современных маркетинговых кампаниях неэффективно просто отправлять предложения всем клиентам: часть из них купят продукт и без предложения (sure things), часть — никогда не купят (lost causes), а некоторым предложение может навредить (sleeping dogs).<br>
<br>
**Uplift-моделирование** направлено на то, чтобы оценить **инкрементальный эффект** (то, как сильно предложение увеличивает вероятность покупки) для каждого клиента и таким образом **направлять предложения только тем клиентам, для которых выгода положительная и максимальна**.<br>
<br>
**Бизнес-цель**:  
Сократить бюджет рассылок / маркетинговых акций и при этом **увеличить чистый прирост конверсий** - точные значения целей см. п.4  


---

## 2. Описание задачи и постановка

- **Тип задачи**: оценка разницы (treatment effect) — задача оценки индивидуального прироста (ITE/CATE).  
- **Тreatment**: рассылка предложения / купона / скидки / промо (0 = контрольная группа, 1 = группа, получившая предложение).  
- **Outcome (y)**: бинарный отклик — покупка (1) или нет (0).  
- **Фичи (X)**: характеристики клиента — демография, история покупок, поведение на сайте, частота визитов и др.

Модель должна выдавать **uplift-скор** для каждого клиента:  

$$uplift(x) = P(y=1 \mid T=1, x) - P(y=1 \mid T=0, x)$$


На основе этого скоринга будет принят бизнес-решение, с кем из клиентов стоит коммуницировать (отправлять предложение).

---

## 3. Датасет / Источники данных

### 3.1 Телеком uplift-моделирование (МЕГАФОН)
[Megafon uplift dataset](https://ods.ai/tracks/df21-megafon/competitions/megafon-df21-comp/data) — синтетический датасет, созданный по мотивам реальных задач телекоммуникационной компании MegaFon. Использовался в конкурсе MegaFon Uplift Competition (май 2021) для тестирования и сравнения методов uplift-моделирования — оценки индивидуального эффекта воздействия (например, маркетинговой кампании).


#### Структура данных
`X_1, X_2, …, X_50` - 50 анонимизированных признаков клиента <br>
`treatment_group` - Метка воздействия (treatment / control) <br>
`conversion` - Целевая переменная, факт конверсии (1 — совершил покупку, 0 — нет) <br>



### 3.2 Ритейл uplift-моделирование (X5)
[X5 uplift dataset](https://ods.ai/competitions/x5-retailhero-uplift-modeling/data) содержит реальные данные, предоставленные X5 Retail Group для хакатона RetailHero (зима 2019).
В набор входят сведения о клиентах, истории покупок и результатах маркетинговых воздействий.
Задача — построить модель, оценивающую uplift-эффект коммуникации на вероятность покупки.

#### Структура данных 
`clients.csv` - Общие сведения о клиентах <br>
`purchases.csv`	- История покупок до воздействия <br>
`uplift_train.csv` - Основные данные для обучения с флагами `treatment_flg` и `target`

#### Основные поля:

`customer_id` — идентификатор клиента<br>
`treatment_flg` — индикатор воздействия (1 — получил коммуникацию, 0 — контроль)<br>
`target` — бинарный отклик (1 — покупка, 0 — нет)<br>

## 4. Метрики и критерии успеха (Target / Eval Metrics)

### 4.1 Бизнес-метрики (для продакшена)

- **Время генерации витрины** и расчёта uplift-скорингов (<1 часа)
- **Среднее время ответа** веб-сервиса (API) ≤ 400 мс  
- **Доля неудачных запросов** (ошибки, таймауты) ≤ 1 %  
- **Использование ресурсов** - RAM < 16GB
- **Конверсия / прирост конверсий**: например, добиться uplift ≥ 5 % (то есть увеличение более чем на 5 п.п.) или прирост абсолютных конверсий на N клиентов  

### 4.2 Метрики качества модели

Поскольку задача — оценка **incremental effect**, 

- **Qini AUC / Qini Coefficient** — площадь под Qini-кривой (≥ 0.02) 
- **Uplift@k** - какой uplift мы получим, если мы «обработаем» топ-k% клиентов (≥ 0.015 (1.5 п.п.) k=30%)
- **AUUC (Area Under Uplift Curve)** - ≥ 0.02 (2.0 п.п.)
- **Аналогичные метрики для групп** (treatment/control)  

---


## 5. План экспериментов / Этапы проекта
<br>

**Исследование данных (EDA):**
   - Проверка сбалансированности treatment/control  
   - Анализ признаков, фильтрация шумов  
   - Проверка конверсий по группам  

**Построение базовой модели uplift (base line)**
   - Методы: Two-model, Class Transformation, T-Learner, X-Learner, Uplift Random Forest  
   - Baseline (логистическая регрессия, два классификатора)

**Оценка моделей**
   - Вычисление заявленных метрик
   - Визуализация uplift-кривых  

**Оптимизация и отбор признаков:**
   - Feature importance / permutation importance  
   - Отбор top-N признаков для продакшена  

**Интеграция и деплой:**
   - Развёртывание batch-инференса через витрину  
   - Расчёт uplift-скорингов и сохранение в feature store  
   - Настройка мониторинга (Qini, Uplift@k, Drift PSI) - потенциально

**Мониторинг** (потенциально)
   - Периодический пересчёт метрик  
   - Drift detection (PSI > 0.1 → warning)  
   - Перетренировка модели при деградации
